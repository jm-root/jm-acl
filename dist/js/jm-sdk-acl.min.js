var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core"),require("jm-ms")),function(){var t=jm.sdk,e=t.storage,i=jm.ms;if(!t.acl){t.on("init",function(e){e.acl=e.acl||{},e.acl.uri=e.acl.uri||e.uri,e.acl.timeout=e.acl.timeout||e.timeout,t.acl.init(e.acl)});var n=function(t,e){};t.acl={init:function(n){var u=this;n=n||{};var r=n.uri,o=n.prefix||"/acl";this.uri=r+o;var a=i();u.client=a,a.use(function(t,i,n){if(t.data||(t.data={}),!t.data.token){var u=e.getItem("token")||null;u&&(t.data.token=u)}n()}),i.client({uri:this.uri,timeout:n.timeout||0},function(e,i){!e&&i&&(a.use({fn:i}),i.on("open",function(){t.emit("open","acl")}),i.on("close",function(){t.emit("close","acl")}))}),jm.enableEvent(this)},isAllowed:function(t,e){e||(e=n),t||(t={});this.client.get({uri:"/isAllowed",data:t},e)},userRoles:function(t,e){e||(e=n),t||(t={});this.client.get({uri:"/userRoles",data:t},e)},userResources:function(t,e){e||(e=n),t||(t={});this.client.get({uri:"/userResources",data:t},e)},reload:function(t,e){e||(e=n),t||(t={});this.client.get({uri:"/reload",data:t},e)},roleResources:function(t,e){e||(e=n),t||(t={});this.client.get({uri:"/roleResources",data:t},e)},addUserRoles:function(t,e){e||(e=n),t||(t={});this.client.put({uri:"/userRoles",data:t},e)},removeUserRoles:function(t,e){e||(e=n),t||(t={});this.client.delete({uri:"/userRoles",data:t},e)}};var u=t.acl;u.role={init:function(t,e){e||(e=n),t||(t={});u.client.post({uri:"/roles/init",data:t},e)},list:function(t,e){e||(e=n),t||(t={});u.client.get({uri:"/roles",data:t},e)}},u.user={list:function(t,e){e||(e=n),t||(t={});u.client.get({uri:"/users",data:t},e)}},u.resource={init:function(t,e){e||(e=n),t||(t={});u.client.post({uri:"/resources/init",data:t},e)},list:function(t,e){e||(e=n),t||(t={});u.client.get({uri:"/resources",data:t},e)},all:function(t,e){e||(e=n),t||(t={});u.client.get({uri:"/resources/all",data:t},e)},tree:function(t,e){e||(e=n),t||(t={});u.client.get({uri:"/resources/tree",data:t},e)}}}}();