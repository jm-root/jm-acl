var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core"),require("jm-ms")),function(){var e=jm.sdk,t=e.storage,i=jm.ms,r="acl";if(!e[r]){e.on("init",function(t){t[r]=t[r]||{},t[r].uri=t[r].uri||t.uri,t[r].timeout=t[r].timeout||t.timeout,e[r].init(t[r])});var n=function(e,t){};e.acl={init:function(n){var u=this;n=n||{};var o=n.uri,a=n.prefix||"/"+r;this.uri=o+a;var s=i();u.client=s,s.use(function(e,i,r){if(e.data||(e.data={}),!e.data.token){var n=t.getItem("token")||null;n&&(e.data.token=n)}r()}),i.client({uri:this.uri,timeout:n.timeout||0},function(t,i){!t&&i&&(s.use({fn:i}),i.on("open",function(){e.emit("open",r)}),i.on("close",function(){e.emit("close",r)}))}),jm.enableEvent(this)},isAllowed:function(e,t){t||(t=n),e||(e={});var i="/isAllowed";this.client.get({uri:i,data:e},t)},userRoles:function(e,t){t||(t=n),e||(e={});var i="/userRoles";this.client.get({uri:i,data:e},t)},userResources:function(e,t){t||(t=n),e||(e={});var i="/userResources";this.client.get({uri:i,data:e},t)},reload:function(e,t){t||(t=n),e||(e={});var i="/reload";this.client.get({uri:i,data:e},t)},roleResources:function(e,t){t||(t=n),e||(e={});var i="/roleResources";this.client.get({uri:i,data:e},t)},addUserRoles:function(e,t){t||(t=n),e||(e={});var i="/addUserRoles";this.client.put({uri:i,data:e},t)},removeUserRoles:function(e,t){t||(t=n),e||(e={});var i="/removeUserRoles";this.client.delete({uri:i,data:e},t)}};var u=e.acl;u.role={fill:function(e,t){t||(t=n),e||(e={});var i="/roles/fill";u.client.post({uri:i,data:e},t)},list:function(e,t){t||(t=n),e||(e={});var i="/roles";u.client.get({uri:i,data:e},t)}},u.user={list:function(e,t){t||(t=n),e||(e={});var i="/users";u.client.get({uri:i,data:e},t)}},u.resource={fill:function(e,t){t||(t=n),e||(e={});var i="/resources/fill";u.client.post({uri:i,data:e},t)},list:function(e,t){t||(t=n),e||(e={});var i="/resources";u.client.get({uri:i,data:e},t)},all:function(e,t){t||(t=n),e||(e={});var i="/resources/all";u.client.get({uri:i,data:e},t)},tree:function(e,t){t||(t=n),e||(e={});var i="/resources/tree";u.client.get({uri:i,data:e},t)}}}}();