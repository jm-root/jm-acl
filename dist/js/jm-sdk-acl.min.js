var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core"),require("jm-ms")),function(){var t=jm.sdk,i=t.storage,e=jm.ms,n="acl";if(!t[n]){t.on("init",function(i){i[n]=i[n]||{},i[n].uri=i[n].uri||i.uri,i[n].timeout=i[n].timeout||i.timeout,t[n].init(i[n])});var u=function(t,i){};t.acl={init:function(u){var o=this;u=u||{};var r=u.uri,a=u.prefix||"/"+n;this.uri=r+a;var s=e();o.client=s,s.use(function(t,e,n){if(t.data||(t.data={}),!t.data.token){var u=i.getItem("token")||null;u&&(t.data.token=u)}n()}),e.client({uri:this.uri,timeout:u.timeout||0},function(i,e){!i&&e&&(s.use({fn:e}),e.on("open",function(){t.emit("open",n)}),e.on("close",function(){t.emit("close",n)}))}),jm.enableEvent(this)},isAllowed:function(t,i){i||(i=u),t||(t={});var e="/isAllowed";this.client.get({uri:e,data:t},i)},userRoles:function(t,i){i||(i=u),t||(t={});var e="/userRoles";this.client.get({uri:e,data:t},i)}};var o=t.acl;o.role={list:function(t,i){i||(i=u),t||(t={});var e="/roles";o.client.get({uri:e,data:t},i)}},o.user={list:function(t,i){i||(i=u),t||(t={});var e="/users";o.client.get({uri:e,data:t},i)}}}}();