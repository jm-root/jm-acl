var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core"),require("jm-ms")),function(){var t=jm.sdk,e=t.storage,i=jm.ms,r="acl";if(!t[r]){t.on("init",function(e){e[r]=e[r]||{},e[r].uri=e[r].uri||e.uri,e[r].timeout=e[r].timeout||e.timeout,t[r].init(e[r])});var n=function(t,e){};t.acl={init:function(n){var u=this;n=n||{};var o=n.uri,a=n.prefix||"/"+r;this.uri=o+a;var s=i();u.client=s,s.use(function(t,i,r){if(t.data||(t.data={}),!t.data.token){var n=e.getItem("token")||null;n&&(t.data.token=n)}r()}),i.client({uri:this.uri,timeout:n.timeout||0},function(e,i){!e&&i&&(s.use({fn:i}),i.on("open",function(){t.emit("open",r)}),i.on("close",function(){t.emit("close",r)}))}),jm.enableEvent(this)},isAllowed:function(t,e){e||(e=n),t||(t={});var i="/isAllowed";this.client.get({uri:i,data:t},e)},userRoles:function(t,e){e||(e=n),t||(t={});var i="/userRoles";this.client.get({uri:i,data:t},e)},userResources:function(t,e){e||(e=n),t||(t={});var i="/userResources";this.client.get({uri:i,data:t},e)},reload:function(t,e){e||(e=n),t||(t={});var i="/reload";this.client.get({uri:i,data:t},e)},roleResources:function(t,e){e||(e=n),t||(t={});var i="/roleResources";this.client.get({uri:i,data:t},e)},addUserRoles:function(t,e){e||(e=n),t||(t={});var i="/userRoles";this.client.put({uri:i,data:t},e)},removeUserRoles:function(t,e){e||(e=n),t||(t={});var i="/userRoles";this.client.delete({uri:i,data:t},e)}};var u=t.acl;u.role={init:function(t,e){e||(e=n),t||(t={});var i="/roles/init";u.client.post({uri:i,data:t},e)},list:function(t,e){e||(e=n),t||(t={});var i="/roles";u.client.get({uri:i,data:t},e)}},u.user={list:function(t,e){e||(e=n),t||(t={});var i="/users";u.client.get({uri:i,data:t},e)}},u.resource={init:function(t,e){e||(e=n),t||(t={});var i="/resources/init";u.client.post({uri:i,data:t},e)},list:function(t,e){e||(e=n),t||(t={});var i="/resources";u.client.get({uri:i,data:t},e)},all:function(t,e){e||(e=n),t||(t={});var i="/resources/all";u.client.get({uri:i,data:t},e)},tree:function(t,e){e||(e=n),t||(t={});var i="/resources/tree";u.client.get({uri:i,data:t},e)}}}}();